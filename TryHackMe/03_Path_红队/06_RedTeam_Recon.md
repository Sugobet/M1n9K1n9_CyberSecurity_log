# Red Team Recon

**“了解你的敌人，了解他的剑，”宫本武藏在他的书《五环之书：战略经典指南》中写道。他还写道：“你通过了解敌人的时间，并使用敌人没有预料到的时机来赢得战斗。虽然这是在剑和矛赢得战斗时写的，但它也适用于网络空间，在那里攻击是通过键盘和精心制作的数据包发起的。您对目标的基础设施和人员了解得越多，就越能更好地策划攻击。**

侦察可以分为两部分 — 被动侦察和主动侦察，如任务 2 中所述。在这个房间里，我们将专注于被动侦察，即不会提醒目标或产生“噪音”的技术。在以后的房间中，我们将使用本质上往往嘈杂的主动侦察工具。

---

## 侦察分类

### 被动侦察

被动侦察不需要与目标交互。换句话说，您不会向目标或目标拥有的系统发送任何数据包或请求。相反，被动侦察依赖于由第三方收集和维护的公开信息。开源情报 （OSINT） 用于收集有关目标的信息，可以像查看目标的公开社交媒体资料一样简单。我们可能收集的示例信息包括域名、IP 地址块、电子邮件地址、员工姓名和职位发布。

### 主动侦察

主动侦察可分为：

- 外部侦察：在目标网络之外进行，重点关注可从互联网评估的外部资产。一个例子是从公司网络外部运行 Nikto。

- 内部侦察：从目标公司的网络内部进行。换句话说，渗透测试员或红队员可能实际位于公司大楼内。在这种情况下，他们可能正在使用目标网络上被利用的主机。例如，使用 Nessus 使用目标计算机之一扫描内部网络。

## 内置工具

此任务侧重于：

- whois
- dig - DNS
- nslookup - DNS
- host - DNS
- traceroute/tracert - Route跟踪

仅使用域名就可以获得大量有价值的信息。查找后，我们可能会很幸运地找到姓名、电子邮件地址、邮政地址和电话号码以及其他技术信息。在查询结束时，我们找到相关域的权威名称服务器。

## 高级搜索

能够有效地使用搜索引擎是一项至关重要的技能。下表显示了适用于许多流行搜索引擎的一些常用搜索修饰符。

| 语法 | 功能 |
| :---: | :---: |
| "search phrase" |	使用精确搜索短语查找结果 |
| OSINT filetype:pdf |	查找与特定术语相关的文件类型。PDF|
| salary site:blog.tryhackme.com |	将搜索结果限制为特定网站。|
| pentest -site:example.com |	从搜索结果中排除特定网站|
| walkthrough intitle:TryHackMe |	查找页面标题中包含特定术语的页面。|
| challenge inurl:tryhackme |	在网页网址中查找包含特定字词的网页。|

搜索引擎日夜抓取万维网，为新的网页和文件编制索引。有时，这可能会导致机密信息编制索引。机密信息的示例包括：

- 供公司内部使用的文件
- 包含用户名、电子邮件地址甚至密码的机密电子表格
- 包含用户名的文件
- 敏感目录
- 服务版本号（其中一些可能易受攻击且未修补）
- 错误消息

将高级Google搜索与特定术语相结合，可以找到包含敏感信息的文档或易受攻击的网络服务器。[谷歌黑客数据库](https://www.exploit-db.com/google-hacking-database)（GHDB）等网站收集此类搜索词并公开可用。

现在，我们将探索另外两个来源，它们可以在不与我们的目标交互的情况下提供有价值的信息：

- 社交媒体
- 招聘广告

### 社交媒体

社交媒体网站不仅在个人使用中而且在企业使用中都变得非常流行。一些社交媒体平台可以透露有关目标的大量信息。尤其如此，因为许多用户倾向于过度分享有关他们自己和他们工作的详细信息。

社交媒体网站可以轻松收集给定公司员工的姓名;此外，在某些情况下，您可能会了解特定的信息，这些信息可以揭示密码恢复问题的答案或获得要包含在目标单词列表中的想法。技术人员的帖子可能会揭示有关公司系统和供应商的详细信息。

例如，最近获得瞻博网络认证的网络工程师可能会暗示其雇主环境中正在使用瞻博网络基础架构。

### 招聘广告

招聘广告还可以告诉您很多关于公司的信息。除了显示姓名和电子邮件地址外，技术职位的职位发布还可以深入了解目标公司的系统和基础设施。热门职位可能因国家/地区而异。请务必查看客户发布广告的国家/地区的职位列表网站。此外，总是值得检查他们的网站是否有任何职位空缺，看看这是否会泄露任何有趣的信息。

## 结束

其中有关recon-ng、付费专业搜索、maltego的详细信息不在此列出，有兴趣可自行了解

## 总结

孙子曾说：“知敌知己知己，百战不惧。如果你知道自己，但不了解敌人，每取得一次胜利，你也会遭受失败。如果你既不了解敌人，也不了解你自己，你就会在每场战斗中屈服。快进到网络战时代;除了了解我们的红队技能和能力外，我们还需要获得尽可能多的关于目标的信息。地形在不断发展，收集数据的新方法正在成为可能。

我们已经回顾了基本的内置工具，如 whois、dig 和 tracert。此外，我们探索了搜索引擎的力量，以帮助我们的被动侦察活动。最后，我们演示了两个工具，Recon-ng和Maltego，它们允许我们从各种来源收集信息并将其呈现在一个地方。

**目的是扩展我们对目标的了解，并收集可以在后续攻击阶段利用的各种信息。例如，可以扫描和探测发现的主机是否存在漏洞，而联系信息和电子邮件地址可用于有效地启动网络钓鱼活动。简而言之，我们收集的有关目标的信息越多，我们就越能改进攻击并增加成功的机会。**
